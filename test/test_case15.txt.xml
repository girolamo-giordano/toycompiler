<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<Program>
    <VarDeclList/>
    <ProcList>
        <Proc>
            (ID,mod)
            <ParamDeclList>
                <ParDecl>
                    <TypeInt>
                        <IdList>(ID,x)(ID,mod)</IdList>
                    </TypeInt>
                </ParDecl>
            </ParamDeclList>
            <ResultTypeList>
                <ResultType>
                    <TypeInt/>
                </ResultType>
            </ResultTypeList>
            <ProcBody>
                <VarDeclList>
                    <VarDecl>
                        <TypeInt>
                            <IdListInit>
                                <IdInit>
                                    (ID,quoziente)
                                    <ExprDiv>
                                        <ExprId>x</ExprId>
                                        <ExprId>mod</ExprId>
                                    </ExprDiv>
                                </IdInit>
                            </IdListInit>
                        </TypeInt>
                    </VarDecl>
                </VarDeclList>
                <ReturnExprs>
                    <ExprList>
                        <ExprMinus>
                            <ExprId>x</ExprId>
                            <ExprTimes>
                                <ExprId>mod</ExprId>
                                <ExprId>quoziente</ExprId>
                            </ExprTimes>
                        </ExprMinus>
                    </ExprList>
                </ReturnExprs>
            </ProcBody>
        </Proc>
        <Proc>
            (ID,power)
            <ParamDeclList>
                <ParDecl>
                    <TypeInt>
                        <IdList>(ID,base)(ID,exponent)</IdList>
                    </TypeInt>
                </ParDecl>
            </ParamDeclList>
            <ResultTypeList>
                <ResultType>
                    <TypeInt/>
                </ResultType>
            </ResultTypeList>
            <ProcBody>
                <VarDeclList>
                    <VarDecl>
                        <TypeInt>
                            <IdListInit>
                                <IdInit>(ID,result)</IdInit>
                                <IdInit>(ID,mod1)</IdInit>
                            </IdListInit>
                        </TypeInt>
                    </VarDecl>
                </VarDeclList>
                <StatList>
                    <StatIf>
                        <IfStat>
                            <IfCond>
                                <ExprEq>
                                    <ExprId>exponent</ExprId>
                                    <ExprIntConst>0</ExprIntConst>
                                </ExprEq>
                            </IfCond>
                            <IfBody>
                                <StatList>
                                    <StatAssign>
                                        <AssignStat>
                                            <AssignOp>
                                                (ID,result)
                                                <ExprIntConst>1</ExprIntConst>
                                            </AssignOp>
                                        </AssignStat>
                                    </StatAssign>
                                </StatList>
                                <ElifList>
                                    <Elif>
                                        <ElifCond>
                                            <ExprEq>
                                                <ExprId>exponent</ExprId>
                                                <ExprIntConst>1</ExprIntConst>
                                            </ExprEq>
                                        </ElifCond>
                                        <ElifBody>
                                            <StatList>
                                                <StatAssign>
                                                    <AssignStat>
                                                        <AssignOp>
                                                            (ID,result)
                                                            <ExprId>base</ExprId>
                                                        </AssignOp>
                                                    </AssignStat>
                                                </StatAssign>
                                            </StatList>
                                        </ElifBody>
                                    </Elif>
                                </ElifList>
                                <Else>
                                    <StatList>
                                        <StatAssign>
                                            <AssignStat>
                                                <AssignOp>
                                                    (ID,mod1)
                                                    <ExprCall>
                                                        <CallProc>
                                                            (ID,mod)
                                                            <ExprId>exponent</ExprId>
                                                            <ExprIntConst>2</ExprIntConst>
                                                        </CallProc>
                                                    </ExprCall>
                                                </AssignOp>
                                            </AssignStat>
                                        </StatAssign>
                                        <StatIf>
                                            <IfStat>
                                                <IfCond>
                                                    <ExprEq>
                                                        <ExprId>mod1</ExprId>
                                                        <ExprIntConst>0</ExprIntConst>
                                                    </ExprEq>
                                                </IfCond>
                                                <IfBody>
                                                    <StatList>
                                                        <StatAssign>
                                                            <AssignStat>
                                                                <AssignOp>
                                                                    (ID,result)
                                                                    <ExprCall>
                                                                        <CallProc>
                                                                            (ID,power)
                                                                            <ExprTimes>
                                                                                <ExprId>base</ExprId>
                                                                                <ExprId>base</ExprId>
                                                                            </ExprTimes>
                                                                            <ExprDiv>
                                                                                <ExprId>exponent</ExprId>
                                                                                <ExprIntConst>2</ExprIntConst>
                                                                            </ExprDiv>
                                                                        </CallProc>
                                                                    </ExprCall>
                                                                </AssignOp>
                                                            </AssignStat>
                                                        </StatAssign>
                                                    </StatList>
                                                    <ElifList/>
                                                    <Else>
                                                        <StatList>
                                                            <StatAssign>
                                                                <AssignStat>
                                                                    <AssignOp>
                                                                        (ID,result)
                                                                        <ExprTimes>
                                                                            <ExprId>base</ExprId>
                                                                            <ExprCall>
                                                                                <CallProc>
                                                                                    (ID,power)
                                                                                    <ExprTimes>
                                                                                        <ExprId>base</ExprId>
                                                                                        <ExprId>base</ExprId>
                                                                                    </ExprTimes>
                                                                                    <ExprDiv>
                                                                                        <ExprId>exponent</ExprId>
                                                                                        <ExprIntConst>2</ExprIntConst>
                                                                                    </ExprDiv>
                                                                                </CallProc>
                                                                            </ExprCall>
                                                                        </ExprTimes>
                                                                    </AssignOp>
                                                                </AssignStat>
                                                            </StatAssign>
                                                        </StatList>
                                                    </Else>
                                                </IfBody>
                                            </IfStat>
                                        </StatIf>
                                    </StatList>
                                </Else>
                            </IfBody>
                        </IfStat>
                    </StatIf>
                </StatList>
                <ReturnExprs>
                    <ExprList>
                        <ExprId>result</ExprId>
                    </ExprList>
                </ReturnExprs>
            </ProcBody>
        </Proc>
        <Proc>
            (ID,isPrimeFermat)
            <ParamDeclList>
                <ParDecl>
                    <TypeInt>
                        <IdList>(ID,n)</IdList>
                    </TypeInt>
                </ParDecl>
            </ParamDeclList>
            <ResultTypeList>
                <ResultType>
                    <TypeBool/>
                </ResultType>
            </ResultTypeList>
            <ProcBody>
                <VarDeclList>
                    <VarDecl>
                        <TypeBool>
                            <IdListInit>
                                <IdInit>(ID,isPrime)</IdInit>
                            </IdListInit>
                        </TypeBool>
                    </VarDecl>
                </VarDeclList>
                <StatList>
                    <StatIf>
                        <IfStat>
                            <IfCond>
                                <ExprOr>
                                    <ExprEq>
                                        <ExprId>n</ExprId>
                                        <ExprIntConst>2</ExprIntConst>
                                    </ExprEq>
                                    <ExprEq>
                                        <ExprId>n</ExprId>
                                        <ExprIntConst>3</ExprIntConst>
                                    </ExprEq>
                                </ExprOr>
                            </IfCond>
                            <IfBody>
                                <StatList>
                                    <StatAssign>
                                        <AssignStat>
                                            <AssignOp>
                                                (ID,isPrime)
                                                <ExprTrue>TRUE</ExprTrue>
                                            </AssignOp>
                                        </AssignStat>
                                    </StatAssign>
                                </StatList>
                                <ElifList/>
                                <Else>
                                    <StatList>
                                        <StatAssign>
                                            <AssignStat>
                                                <AssignOp>
                                                    (ID,isPrime)
                                                    <ExprAnd>
                                                        <ExprAnd>
                                                            <ExprEq>
                                                                <ExprCall>
                                                                    <CallProc>
                                                                        (ID,mod)
                                                                        <ExprCall>
                                                                            <CallProc>
                                                                                (ID,power)
                                                                                <ExprIntConst>2</ExprIntConst>
                                                                                <ExprId>n</ExprId>
                                                                            </CallProc>
                                                                        </ExprCall>
                                                                        <ExprId>n</ExprId>
                                                                    </CallProc>
                                                                </ExprCall>
                                                                <ExprIntConst>2</ExprIntConst>
                                                            </ExprEq>
                                                            <ExprEq>
                                                                <ExprCall>
                                                                    <CallProc>
                                                                        (ID,mod)
                                                                        <ExprCall>
                                                                            <CallProc>
                                                                                (ID,power)
                                                                                <ExprIntConst>3</ExprIntConst>
                                                                                <ExprId>n</ExprId>
                                                                            </CallProc>
                                                                        </ExprCall>
                                                                        <ExprId>n</ExprId>
                                                                    </CallProc>
                                                                </ExprCall>
                                                                <ExprIntConst>3</ExprIntConst>
                                                            </ExprEq>
                                                        </ExprAnd>
                                                        <ExprEq>
                                                            <ExprCall>
                                                                <CallProc>
                                                                    (ID,mod)
                                                                    <ExprCall>
                                                                        <CallProc>
                                                                            (ID,power)
                                                                            <ExprIntConst>4</ExprIntConst>
                                                                            <ExprId>n</ExprId>
                                                                        </CallProc>
                                                                    </ExprCall>
                                                                    <ExprId>n</ExprId>
                                                                </CallProc>
                                                            </ExprCall>
                                                            <ExprIntConst>4</ExprIntConst>
                                                        </ExprEq>
                                                    </ExprAnd>
                                                </AssignOp>
                                            </AssignStat>
                                        </StatAssign>
                                    </StatList>
                                </Else>
                            </IfBody>
                        </IfStat>
                    </StatIf>
                </StatList>
                <ReturnExprs>
                    <ExprList>
                        <ExprId>isPrime</ExprId>
                    </ExprList>
                </ReturnExprs>
            </ProcBody>
        </Proc>
        <Proc>
            (ID,isPrime2)
            <ParamDeclList>
                <ParDecl>
                    <TypeInt>
                        <IdList>(ID,n)</IdList>
                    </TypeInt>
                </ParDecl>
            </ParamDeclList>
            <ResultTypeList>
                <ResultType>
                    <TypeBool/>
                </ResultType>
            </ResultTypeList>
            <ProcBody>
                <VarDeclList>
                    <VarDecl>
                        <TypeInt>
                            <IdListInit>
                                <IdInit>
                                    (ID,i)
                                    <ExprIntConst>2</ExprIntConst>
                                </IdInit>
                            </IdListInit>
                        </TypeInt>
                    </VarDecl>
                    <VarDecl>
                        <TypeBool>
                            <IdListInit>
                                <IdInit>
                                    (ID,found)
                                    <ExprFalse>FALSE</ExprFalse>
                                </IdInit>
                            </IdListInit>
                        </TypeBool>
                    </VarDecl>
                </VarDeclList>
                <StatList>
                    <StatIf>
                        <IfStat>
                            <IfCond>
                                <ExprOr>
                                    <ExprEq>
                                        <ExprId>n</ExprId>
                                        <ExprIntConst>2</ExprIntConst>
                                    </ExprEq>
                                    <ExprEq>
                                        <ExprId>n</ExprId>
                                        <ExprIntConst>3</ExprIntConst>
                                    </ExprEq>
                                </ExprOr>
                            </IfCond>
                            <IfBody>
                                <StatList>
                                    <StatWrite>
                                        <WriteStat>
                                            <ExprList>
                                                <ExprStringConst>ciao</ExprStringConst>
                                            </ExprList>
                                        </WriteStat>
                                    </StatWrite>
                                </StatList>
                                <ElifList/>
                                <Else>
                                    <StatList>
                                        <StatWhile>
                                            <WhileStat>
                                                <ExprAnd>
                                                    <ExprLe>
                                                        <ExprId>i</ExprId>
                                                        <ExprDiv>
                                                            <ExprId>n</ExprId>
                                                            <ExprIntConst>2</ExprIntConst>
                                                        </ExprDiv>
                                                    </ExprLe>
                                                    <ExprNot>
                                                        <ExprId>found</ExprId>
                                                    </ExprNot>
                                                </ExprAnd>
                                                <WhileBody>
                                                    <StatList>
                                                        <StatIf>
                                                            <IfStat>
                                                                <IfCond>
                                                                    <ExprEq>
                                                                        <ExprCall>
                                                                            <CallProc>
                                                                                (ID,mod)
                                                                                <ExprId>n</ExprId>
                                                                                <ExprId>i</ExprId>
                                                                            </CallProc>
                                                                        </ExprCall>
                                                                        <ExprIntConst>0</ExprIntConst>
                                                                    </ExprEq>
                                                                </IfCond>
                                                                <IfBody>
                                                                    <StatList>
                                                                        <StatAssign>
                                                                            <AssignStat>
                                                                                <AssignOp>
                                                                                    (ID,found)
                                                                                    <ExprTrue>TRUE</ExprTrue>
                                                                                </AssignOp>
                                                                            </AssignStat>
                                                                        </StatAssign>
                                                                    </StatList>
                                                                    <ElifList/>
                                                                    <Else/>
                                                                </IfBody>
                                                            </IfStat>
                                                        </StatIf>
                                                        <StatAssign>
                                                            <AssignStat>
                                                                <AssignOp>
                                                                    (ID,i)
                                                                    <ExprPlus>
                                                                        <ExprId>i</ExprId>
                                                                        <ExprIntConst>1</ExprIntConst>
                                                                    </ExprPlus>
                                                                </AssignOp>
                                                            </AssignStat>
                                                        </StatAssign>
                                                    </StatList>
                                                </WhileBody>
                                            </WhileStat>
                                        </StatWhile>
                                    </StatList>
                                </Else>
                            </IfBody>
                        </IfStat>
                    </StatIf>
                </StatList>
                <ReturnExprs>
                    <ExprList>
                        <ExprNot>
                            <ExprId>found</ExprId>
                        </ExprNot>
                    </ExprList>
                </ReturnExprs>
            </ProcBody>
        </Proc>
        <Proc>
            (ID,main)
            <ResultTypeList>
                <ResultType>
                    <Type/>
                </ResultType>
            </ResultTypeList>
            <ProcBody>
                <VarDeclList>
                    <VarDecl>
                        <TypeInt>
                            <IdListInit>
                                <IdInit>(ID,n)</IdInit>
                            </IdListInit>
                        </TypeInt>
                    </VarDecl>
                    <VarDecl>
                        <TypeString>
                            <IdListInit>
                                <IdInit>(ID,str)</IdInit>
                            </IdListInit>
                        </TypeString>
                    </VarDecl>
                </VarDeclList>
                <StatList>
                    <StatWrite>
                        <WriteStat>
                            <ExprList>
                                <ExprStringConst>Inserisci un numero positivo (&gt; 1) per controllare se e' primo (0 per chiudere): </ExprStringConst>
                            </ExprList>
                        </WriteStat>
                    </StatWrite>
                    <StatReadln>
                        <ReadlnStat>
                            <IdList>(ID,n)</IdList>
                        </ReadlnStat>
                    </StatReadln>
                    <StatWhile>
                        <WhileStat>
                            <ExprGt>
                                <ExprId>n</ExprId>
                                <ExprIntConst>1</ExprIntConst>
                            </ExprGt>
                            <WhileBody>
                                <StatList>
                                    <StatIf>
                                        <IfStat>
                                            <IfCond>
                                                <ExprCall>
                                                    <CallProc>
                                                        (ID,isPrime2)
                                                        <ExprId>n</ExprId>
                                                    </CallProc>
                                                </ExprCall>
                                            </IfCond>
                                            <IfBody>
                                                <StatList>
                                                    <StatWrite>
                                                        <WriteStat>
                                                            <ExprList>
                                                                <ExprId>n</ExprId>
                                                                <ExprStringConst> è un numero primo
</ExprStringConst>
                                                            </ExprList>
                                                        </WriteStat>
                                                    </StatWrite>
                                                </StatList>
                                                <ElifList/>
                                                <Else>
                                                    <StatList>
                                                        <StatWrite>
                                                            <WriteStat>
                                                                <ExprList>
                                                                    <ExprId>n</ExprId>
                                                                    <ExprStringConst> non è un numero primo
</ExprStringConst>
                                                                </ExprList>
                                                            </WriteStat>
                                                        </StatWrite>
                                                    </StatList>
                                                </Else>
                                            </IfBody>
                                        </IfStat>
                                    </StatIf>
                                </StatList>
                            </WhileBody>
                        </WhileStat>
                    </StatWhile>
                </StatList>
                <ReturnExprs/>
            </ProcBody>
        </Proc>
    </ProcList>
</Program>
